<% block content %>
  <%= before_widget | raw %>

  <% if(title) %>
    <h2 class="widget-title"><%= title | raw %></h2>
  <% endif %>

  <div id="<%= form_id %>" class="mailpoet_form mailpoet_form_<%= form_type %>">
    <%= styles | raw %>
    <form
      method="post"
      action="<%= admin_url('admin-post.php?action=mailpoet') | raw %>"
      class="mailpoet_form mailpoet_form_<%= form_type %>"
      novalidate
    >
      <input type="hidden" name="form_id" value="<%= form.id %>" />
      <input type="hidden" name="token" value="<%= token %>" />
      <input type="hidden" name="endpoint" value="subscribers" />
      <input type="hidden" name="method" value="subscribe" />

      <% if not(form.settings.segments_selected_by == 'user') %>
        <% for segment in form.settings.segments %>
        <input type="hidden" name="segments[]" value="<%= segment %>" />
        <% endfor %>
      <% endif %>
      <%= html | raw %>
      <div class="mailpoet_message">
        <p
          class="mailpoet_validate_success"
          <% if not(success) %>
          style="display:none;"
          <% endif %>
        ><%= form.settings.success_message %></p>
        <p class="mailpoet_validate_error"
          <% if not(error) %>
          style="display:none;"
          <% endif %>
        ><% if (error) %>
           <%= __("An error occurred, make sure you have filled all the required fields.") %>
          <% endif %>
        </p>
      </div>
    </form>
  </div>
  <%= after_widget | raw %>
<% endblock %>